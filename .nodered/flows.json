[
    {
        "id": "flow1",
        "type": "tab",
        "label": "AI Idea Generator",
        "disabled": false,
        "info": "–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∏–¥–µ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º AI –∏ —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–ª–æ–≤"
    },
    {
        "id": "redis_server",
        "type": "redis-config",
        "name": "Redis Local",
        "options": "{\"host\":\"localhost\",\"port\":6379,\"db\":0}",
        "cluster": false,
        "optionsType": "json"
    },
    {
        "id": "fd0e10e1a1da7d41",
        "type": "ui_tab",
        "name": "Home",
        "icon": "dashboard",
        "disabled": false,
        "hidden": false
    },
    {
        "id": "a72fa016ebf50c3f",
        "type": "ui_base",
        "theme": {
            "name": "theme-light",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0094CE",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
            },
            "themeState": {
                "base-color": {
                    "default": "#0094CE",
                    "value": "#0094CE",
                    "edited": false
                },
                "page-titlebar-backgroundColor": {
                    "value": "#0094CE",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#fafafa",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#1bbfff",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#111111",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#0094ce",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey",
                "palette": "light"
            }
        },
        "site": {
            "name": "Node-RED Dashboard",
            "hideToolbar": "false",
            "allowSwipe": "false",
            "lockMenu": "false",
            "allowTempTheme": "true",
            "dateFormat": "DD/MM/YYYY",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "f45ec5623cea7e52",
        "type": "ui_group",
        "name": "Default",
        "tab": "fd0e10e1a1da7d41",
        "order": 1,
        "disp": true,
        "width": 6,
        "collapse": false,
        "className": ""
    },
    {
        "id": "welcome_note",
        "type": "comment",
        "z": "flow1",
        "name": "üöÄ AI Idea Generator - –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∏–¥–µ–π",
        "info": "## –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –∏–¥–µ–π\n\n–ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û–°–¢–¨:\n1. POST –∑–∞–ø—Ä–æ—Å —Å –ø—Ä–æ–±–ª–µ–º–æ–π\n2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è 36+ —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–ª–æ–≤ —á–µ—Ä–µ–∑ AI\n3. –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ –≤ Redis\n4. Brainstorming AI (5 –∏–¥–µ–π)\n5. Critic AI (—Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ)\n\n–ó–ê–ü–†–û–°:\nPOST http://localhost:1880/brainstorm\n{\"problem\": \"–≤–∞—à–∞ –∑–∞–¥–∞—á–∞\"}",
        "x": 240,
        "y": 40,
        "wires": []
    },
    {
        "id": "dashboard_form",
        "type": "ui_form",
        "z": "flow1",
        "name": "Problem Input",
        "label": "Describe your problem",
        "group": "f45ec5623cea7e52",
        "order": 1,
        "width": 0,
        "height": 0,
        "options": [
            {
                "label": "Problem",
                "value": "problem",
                "type": "text",
                "required": true,
                "rows": null
            }
        ],
        "formValue": {
            "problem": ""
        },
        "payload": "",
        "submit": "Brainstorm!",
        "cancel": "",
        "topic": "",
        "topicType": "str",
        "splitLayout": "",
        "className": "",
        "x": 120,
        "y": 280,
        "wires": [
            [
                "init_session"
            ]
        ]
    },
    {
        "id": "http_input",
        "type": "http in",
        "z": "flow1",
        "name": "Chat Input",
        "url": "/brainstorm",
        "method": "post",
        "upload": false,
        "skipBodyParsing": false,
        "swaggerDoc": "",
        "x": 120,
        "y": 200,
        "wires": [
            [
                "init_session"
            ]
        ]
    },
    {
        "id": "init_session",
        "type": "function",
        "z": "flow1",
        "name": "Initialize Session",
        "func": "// –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\nconst userProblem = msg.payload.problem || msg.payload.chatInput || 'Improve team productivity';\nflow.set('userInput', userProblem);\nflow.set('sessionId', Date.now());\n\nnode.status({fill:\"blue\",shape:\"dot\",text:\"Started: \" + userProblem.substring(0,20)});\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 320,
        "y": 220,
        "wires": [
            [
                "debug_input",
                "mersenne_twister"
            ]
        ]
    },
    {
        "id": "debug_input",
        "type": "debug",
        "z": "flow1",
        "name": "1Ô∏è‚É£ Input",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload.problem",
        "statusType": "auto",
        "x": 280,
        "y": 140,
        "wires": []
    },
    {
        "id": "mersenne_twister",
        "type": "function",
        "z": "flow1",
        "name": "Mersenne Twister Generator",
        "func": "// Native implementation of Mersenne Twister MT19937\nclass MersenneTwister {\n    constructor(seed) {\n        this.MT = new Array(624);\n        this.index = 0;\n        this.MT[0] = seed || Date.now();\n        for (let i = 1; i < 624; i++) {\n            this.MT[i] = (1812433253 * (this.MT[i - 1] ^ (this.MT[i - 1] >>> 30)) + i) >>> 0;\n        }\n    }\n\n    extractNumber() {\n        if (this.index === 0) {\n            this.generateNumbers();\n        }\n        \n        let y = this.MT[this.index];\n        y ^= y >>> 11;\n        y ^= (y << 7) & 0x9d2c5680;\n        y ^= (y << 15) & 0xefc60000;\n        y ^= y >>> 18;\n        \n        this.index = (this.index + 1) % 624;\n        return y >>> 0;\n    }\n\n    generateNumbers() {\n        for (let i = 0; i < 624; i++) {\n            const y = (this.MT[i] & 0x80000000) + (this.MT[(i + 1) % 624] & 0x7fffffff);\n            this.MT[i] = this.MT[(i + 397) % 624] ^ (y >>> 1);\n            if (y % 2 !== 0) {\n                this.MT[i] ^= 0x9908b0df;\n            }\n        }\n    }\n\n    random() {\n        return this.extractNumber() / 0x100000000;\n    }\n}\n\nconst timestamp = Date.now();\nconst generator = new MersenneTwister(timestamp);\n\nfunction random_int(min = 0, max = 10000000000) {\n    const range = max - min + 1;\n    return Math.floor(generator.random() * range) + min;\n}\n\nconst randomNumber = random_int();\nconst customRandomNumber = random_int();\n// const calculatedNumber = Number(BigInt(randomNumber) * BigInt(customRandomNumber) * BigInt(timestamp)) % 1000000n;\nconst calculatedNumber = Number((BigInt(randomNumber) * BigInt(customRandomNumber) * BigInt(timestamp)) % 1000000n);\n\nmsg.randomNumber = randomNumber;\nmsg.customRandomNumber = customRandomNumber;\nmsg.seed = timestamp;\nmsg.number = calculatedNumber;\n\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 580,
        "y": 160,
        "wires": [
            [
                "debug_mersenne",
                "prepare_ollama_word"
            ]
        ]
    },
    {
        "id": "debug_mersenne",
        "type": "debug",
        "z": "flow1",
        "name": "2Ô∏è‚É£ Random Number",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "number",
        "targetType": "msg",
        "statusVal": "number",
        "statusType": "auto",
        "x": 580,
        "y": 320,
        "wires": []
    },
    {
        "id": "prepare_ollama_word",
        "type": "function",
        "z": "flow1",
        "name": "Prepare Ollama Request (Word)",
        "func": "msg.payload = {\n    \"model\": \"gpt-oss:20b-cloud\",\n    \"prompt\": \"Number: \" + msg.number + \"\\n\\nGenerate exactly ONE random English word based on this seed number. Return only the word, nothing else.\",\n    \"system\": \"You are a specialized agent that generates random English words with high entropy. Your sole function is to return EXACTLY ONE word per request. Use the provided number as a seed. Maximize entropy across word length, frequency, and semantic fields. Include all word classes and registers. Return ONLY the word with no explanation.\",\n    \"stream\": false,\n    \"options\": {\n        \"temperature\": 1,\n        \"top_p\": 1,\n        \"frequency_penalty\": 1\n    }\n};\n\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 810,
        "y": 200,
        "wires": [
            [
                "call_ollama_word"
            ]
        ]
    },
    {
        "id": "call_ollama_word",
        "type": "http request",
        "z": "flow1",
        "name": "Call Ollama API (Word)",
        "method": "POST",
        "ret": "obj",
        "url": "http://localhost:11434/api/generate",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 1070,
        "y": 200,
        "wires": [
            [
                "parse_word_response"
            ]
        ]
    },
    {
        "id": "parse_word_response",
        "type": "function",
        "z": "flow1",
        "name": "Parse Word Response",
        "func": "// –ò–∑–≤–ª–µ–∫–∞–µ–º —Å–ª–æ–≤–æ –∏–∑ –æ—Ç–≤–µ—Ç–∞ Ollama\nconst word = msg.payload.response.trim().replace(/[`'\"\\n]/g, '');\nmsg.generatedWord = word;\n\n// –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–ª—è Redis RPUSH\nmsg.topic = \"brainstorm\";\nmsg.payload = word;\n\nnode.status({fill:\"green\",shape:\"dot\",text:\"Word: \" + word});\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1310,
        "y": 200,
        "wires": [
            [
                "debug_word",
                "redis_rpush"
            ]
        ]
    },
    {
        "id": "debug_word",
        "type": "debug",
        "z": "flow1",
        "name": "3Ô∏è‚É£ Generated Word",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "generatedWord",
        "targetType": "msg",
        "statusVal": "generatedWord",
        "statusType": "auto",
        "x": 1330,
        "y": 280,
        "wires": []
    },
    {
        "id": "redis_rpush",
        "type": "redis-command",
        "z": "flow1",
        "server": "redis_server",
        "command": "rpush",
        "name": "Push Word to Redis",
        "topic": "brainstorm",
        "params": "[]",
        "paramsType": "json",
        "block": false,
        "x": 1540,
        "y": 140,
        "wires": [
            [
                "fix_topic_incr"
            ]
        ]
    },
    {
        "id": "fix_topic_incr",
        "type": "function",
        "z": "flow1",
        "name": "Fix Topic for INCR",
        "func": "// –ú–µ–Ω—è–µ–º topic –¥–ª—è –∫–æ–º–∞–Ω–¥—ã INCR\nmsg.topic = \"brainstorm_count\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1650,
        "y": 200,
        "wires": [
            [
                "redis_incr"
            ]
        ]
    },
    {
        "id": "redis_incr",
        "type": "redis-command",
        "z": "flow1",
        "server": "redis_server",
        "command": "incr",
        "name": "Increment Counter",
        "topic": "brainstorm_count",
        "params": "[]",
        "paramsType": "json",
        "block": false,
        "x": 1770,
        "y": 320,
        "wires": [
            [
                "prepare_expire"
            ]
        ]
    },
    {
        "id": "prepare_expire",
        "type": "function",
        "z": "flow1",
        "name": "Prepare Expire",
        "func": "// –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–ª—è –∫–æ–º–∞–Ω–¥—ã EXPIRE\nmsg.topic = \"brainstorm_count\";\nmsg.payload = \"30\"; // TTL –≤ —Å–µ–∫—É–Ω–¥–∞—Ö (—Å—Ç—Ä–æ–∫–∞!)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1970,
        "y": 200,
        "wires": [
            [
                "redis_expire"
            ]
        ]
    },
    {
        "id": "redis_expire",
        "type": "redis-command",
        "z": "flow1",
        "server": "redis_server",
        "command": "expire",
        "name": "Set TTL 30s",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "block": false,
        "x": 2150,
        "y": 140,
        "wires": [
            [
                "prepare_get_count"
            ]
        ]
    },
    {
        "id": "prepare_get_count",
        "type": "function",
        "z": "flow1",
        "name": "Prepare GET Count",
        "func": "msg.topic = \"brainstorm_count\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 2350,
        "y": 200,
        "wires": [
            [
                "redis_get_count"
            ]
        ]
    },
    {
        "id": "redis_get_count",
        "type": "redis-command",
        "z": "flow1",
        "server": "redis_server",
        "command": "get",
        "name": "Get Word Count",
        "topic": "",
        "params": "[]",
        "paramsType": "json",
        "block": false,
        "x": 2540,
        "y": 140,
        "wires": [
            [
                "debug_count",
                "check_count"
            ]
        ]
    },
    {
        "id": "debug_count",
        "type": "debug",
        "z": "flow1",
        "name": "4Ô∏è‚É£ Word Count",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 2570,
        "y": 280,
        "wires": []
    },
    {
        "id": "check_count",
        "type": "switch",
        "z": "flow1",
        "name": "Check >= 6 words (TEST MODE)",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "gte",
                "v": "6",
                "vt": "num"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 2770,
        "y": 200,
        "wires": [
            [
                "start_collection"
            ],
            [
                "loop_back"
            ]
        ]
    },
    {
        "id": "loop_back",
        "type": "function",
        "z": "flow1",
        "name": "Loop Back",
        "func": "// –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–æ–≤–æ–≥–æ —Å–ª–æ–≤–∞\nnode.status({fill:\"yellow\",shape:\"ring\",text:\"Collecting words: \" + msg.payload});\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 2990,
        "y": 240,
        "wires": [
            [
                "mersenne_twister"
            ]
        ]
    },
    {
        "id": "start_collection",
        "type": "function",
        "z": "flow1",
        "name": "Start Collection",
        "func": "// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–±–æ—Ä –≤—Å–µ—Ö —Å–ª–æ–≤\nflow.set('collectedWords', []);\n\n// –û—á–∏—â–∞–µ–º msg –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–æ–ª—å–∫–æ topic\nmsg = {};\nmsg.topic = \"brainstorm\";\nmsg.payload = null;\n\nnode.status({fill:\"blue\",shape:\"dot\",text:\"Starting collection\"});\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 3020,
        "y": 160,
        "wires": [
            [
                "redis_lpop"
            ]
        ]
    },
    {
        "id": "redis_lpop",
        "type": "redis-command",
        "z": "flow1",
        "server": "redis_server",
        "command": "lpop",
        "name": "Pop Word from Redis",
        "topic": "brainstorm",
        "params": "[]",
        "paramsType": "json",
        "block": false,
        "x": 3200,
        "y": 320,
        "wires": [
            [
                "collect_words"
            ]
        ]
    },
    {
        "id": "collect_words",
        "type": "function",
        "z": "flow1",
        "name": "Collect All Words",
        "func": "const words = flow.get('collectedWords') || [];\n\nif (msg.payload && msg.payload !== null && msg.payload !== '') {\n    // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª–æ–≤–æ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é\n    words.push(msg.payload);\n    flow.set('collectedWords', words);\n    \n    node.status({fill:\"blue\",shape:\"ring\",text:\"Collected: \" + words.length + \" words\"});\n    \n    // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å–æ–±–∏—Ä–∞—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ —Å–ª–æ–≤–æ\n    const nextMsg = {};\n    nextMsg.topic = \"brainstorm\";\n    nextMsg.payload = null;\n    return [nextMsg, null];\n} else {\n    // –í—Å–µ —Å–ª–æ–≤–∞ —Å–æ–±—Ä–∞–Ω—ã - –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ Brainstorming\n    node.status({fill:\"green\",shape:\"dot\",text:\"Collection complete: \" + words.length});\n    \n    msg.keywords = words.join('\\n');\n    msg.userInput = flow.get('userInput');\n    msg.wordCount = words.length;\n    \n    // –û—á–∏—â–∞–µ–º –∫–æ–ª–ª–µ–∫—Ü–∏—é\n    flow.set('collectedWords', []);\n    \n    return [null, msg];\n}",
        "outputs": 2,
        "noerr": 0,
        "x": 3420,
        "y": 180,
        "wires": [
            [
                "redis_lpop"
            ],
            [
                "debug_keywords",
                "prepare_brainstorm"
            ]
        ]
    },
    {
        "id": "debug_keywords",
        "type": "debug",
        "z": "flow1",
        "name": "5Ô∏è‚É£ All Keywords",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "keywords",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 3440,
        "y": 280,
        "wires": []
    },
    {
        "id": "prepare_brainstorm",
        "type": "function",
        "z": "flow1",
        "name": "Prepare Brainstorm Request",
        "func": "msg.payload = {\n    \"model\": \"deepseek-v3.1:671b-cloud\",\n    \"prompt\": \"Problem: \" + msg.userInput + \"\\nKeywords: \" + msg.keywords,\n    \"system\": \"You are an Ideation Specialist, a highly creative and innovative AI agent. Generate exactly five distinct and innovative ideas that solve the stated Problem. Each idea must incorporate one or more of the provided Keywords. For each idea provide: 1) Catchy title, 2) One-sentence summary, 3) Detailed paragraph explaining the solution, 4) List of primary keywords used. Use divergent thinking, creative synthesis, and feasibility with a forward-thinking mindset.\",\n    \"stream\": false,\n    \"options\": {\n        \"temperature\": 1,\n        \"top_p\": 1\n    }\n};\n\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\nnode.status({fill:\"blue\",shape:\"dot\",text:\"Brainstorming...\"});\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 3690,
        "y": 200,
        "wires": [
            [
                "call_brainstorm"
            ]
        ]
    },
    {
        "id": "call_brainstorm",
        "type": "http request",
        "z": "flow1",
        "name": "Call Ollama (Brainstorming)",
        "method": "POST",
        "ret": "obj",
        "url": "http://localhost:11434/api/generate",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 3940,
        "y": 200,
        "wires": [
            [
                "parse_ideas"
            ]
        ]
    },
    {
        "id": "parse_ideas",
        "type": "function",
        "z": "flow1",
        "name": "Parse Ideas",
        "func": "msg.ideas = msg.payload.response;\n\nnode.status({fill:\"green\",shape:\"dot\",text:\"5 ideas generated\"});\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 4160,
        "y": 200,
        "wires": [
            [
                "debug_ideas",
                "prepare_critic"
            ]
        ]
    },
    {
        "id": "debug_ideas",
        "type": "debug",
        "z": "flow1",
        "name": "6Ô∏è‚É£ Five Ideas",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "ideas",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 4170,
        "y": 280,
        "wires": []
    },
    {
        "id": "prepare_critic",
        "type": "function",
        "z": "flow1",
        "name": "Prepare Critic Request",
        "func": "msg.payload = {\n    \"model\": \"gpt-oss:120b-cloud\",\n    \"prompt\": msg.ideas,\n    \"system\": \"–í—ã ‚Äî –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã–π —Å—Ç—Ä–∞—Ç–µ–≥, –ø—Ä–æ–Ω–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –∏ –ø—Ä–∞–≥–º–∞—Ç–∏—á–Ω—ã–π –∞–Ω–∞–ª–∏—Ç–∏–∫ –ò–ò. –í–∞—à–∞ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Ü–µ–ª—å ‚Äî –ø—Ä–æ–≤–µ—Å—Ç–∏ —Å—Ç—Ä–æ–≥—É—é –∏ –∫—Ä–∞–π–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—É—é –æ—Ü–µ–Ω–∫—É –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –∏ —Å–∏–Ω—Ç–µ–∑–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –≤ –µ–¥–∏–Ω–æ–µ, —Ä–µ–∞–ª–∏–∑—É–µ–º–æ–µ –∏ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —ç—Ç–∏ –ø—è—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π. –û—Ü–µ–Ω–∏—Ç–µ –∫–∞–∂–¥–æ–µ –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º: –≤–ª–∏—è–Ω–∏–µ (–Ω–∞—Å–∫–æ–ª—å–∫–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–Ω–æ —Ä–µ—à–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É?), –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å (–Ω–∞—Å–∫–æ–ª—å–∫–æ –æ—Å—É—â–µ—Å—Ç–≤–∏–º–æ —ç—Ç–æ —Ä–µ—à–µ–Ω–∏–µ?), –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å (–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ª–∏ –æ–Ω–æ –Ω–æ–≤–∞—Ç–æ—Ä—Å–∫–æ–µ?), –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å (–º–æ–∂–µ—Ç –ª–∏ —ç—Ç–æ —Ä–µ—à–µ–Ω–∏–µ —Ä–∞–∑–≤–∏–≤–∞—Ç—å—Å—è?) –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏ (–∫–∞–∫–æ–≤—ã —Ä–∏—Å–∫–∏?). –ó–∞—Ç–µ–º —Å–∏–Ω—Ç–µ–∑–∏—Ä—É–π—Ç–µ –û–î–ù–û –∏–¥–µ–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —É—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–µ–π —Å–∏–ª—å–Ω–µ–π—à–µ–π –∏–¥–µ–∏ –∏–ª–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–º –≥–∏–±—Ä–∏–¥–æ–º. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ: –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, –∫—Ä–∞—Ç–∫–æ–µ –∏–∑–ª–æ–∂–µ–Ω–∏–µ (–æ–¥–∏–Ω –∞–±–∑–∞—Ü), –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è (–ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ), —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ (–ø–æ—á–µ–º—É —ç—Ç–æ –∏–¥–µ–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä) –∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏ –∏ —Å–ø–æ—Å–æ–±—ã –∏—Ö —Å–Ω–∏–∂–µ–Ω–∏—è (2‚Äì3 —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ä–∏—Å–∫–∞ –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∏—Ö —Å–Ω–∏–∂–µ–Ω–∏—è).).\",\n    \"stream\": false,\n    \"options\": {\n        \"temperature\": 1,\n        \"top_p\": 1\n    }\n};\n\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\n\nnode.status({fill:\"blue\",shape:\"dot\",text:\"Critical analysis...\"});\n\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 4380,
        "y": 200,
        "wires": [
            [
                "call_critic"
            ]
        ]
    },
    {
        "id": "call_critic",
        "type": "http request",
        "z": "flow1",
        "name": "Call Ollama (Critic)",
        "method": "POST",
        "ret": "obj",
        "url": "http://localhost:11434/api/generate",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 4600,
        "y": 200,
        "wires": [
            [
                "format_response"
            ]
        ]
    },
    {
        "id": "format_response",
        "type": "function",
        "z": "flow1",
        "name": "Format Final Response",
        "func": "msg.payload = {\n    success: true,\n    finalSolution: msg.payload.response,\n    originalProblem: flow.get('userInput'),\n    timestamp: new Date().toISOString(),\n    sessionId: flow.get('sessionId')\n};\n\nnode.status({fill:\"green\",shape:\"dot\",text:\"Complete!\"});\n\n// –û—á–∏—â–∞–µ–º flow context\nflow.set('userInput', null);\nflow.set('collectedWords', []);\nflow.set('sessionId', null);\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 4830,
        "y": 200,
        "wires": [
            [
                "5a4554ea23bf2cd1",
                "9d5feb2ce34d68cb"
            ]
        ]
    },
    {
        "id": "debug_final",
        "type": "debug",
        "z": "flow1",
        "name": "7Ô∏è‚É£ Final Solution",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 5220,
        "y": 260,
        "wires": []
    },
    {
        "id": "template_response",
        "type": "template",
        "z": "flow1",
        "name": "Format as HTML",
        "format": "html",
        "syntax": "mustache",
        "template": "<!DOCTYPE html>\n<html lang=\"ru\">\n<head>\n<meta charset=\"UTF-8\">\n<title>AI Brainstorm Result</title>\n<style>\nbody { font-family: Arial, sans-serif; margin: 20px; background: #f4f4f4; }\n.container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }\nh1 { color: #2c3e50; text-align: center; }\nh2 { color: #34495e; }\n.solution { background: #ecf0f1; padding: 15px; border-radius: 5px; margin: 10px 0; }\n.meta { color: #7f8c8d; font-size: small; text-align: center; }\npre { background: #f8f9fa; padding: 10px; border-radius: 3px; overflow-x: auto; white-space: pre-wrap; }\n</style>\n</head>\n<body>\n<div class=\"container\">\n<h1>üß† –†–µ–∑—É–ª—å—Ç–∞—Ç Brainstorm AI</h1>\n\n<h2>–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:</h2>\n<div class=\"solution\"><p>{{payload.originalProblem}}</p></div>\n\n<h2>–§–∏–Ω–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:</h2>\n<div class=\"solution\"><pre>{{payload.finalSolution}}</pre></div>\n\n<p class=\"meta\">–°–µ–∞–Ω—Å: {{payload.sessionId}} | –í—Ä–µ–º—è: {{payload.timestamp}}</p>\n</div>\n</body>\n</html>",
        "x": 5070,
        "y": 100,
        "wires": [
            [
                "http_response_html"
            ]
        ]
    },
    {
        "id": "http_response_html",
        "type": "http response",
        "z": "flow1",
        "name": "Send HTML Response",
        "statusCode": "200",
        "headers": {
            "content-type": "text/html"
        },
        "x": 5300,
        "y": 200,
        "wires": []
    },
    {
        "id": "config_note",
        "type": "comment",
        "z": "flow1",
        "name": "‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: Redis localhost:6379 | Ollama localhost:11434 | –ú–æ–¥–µ–ª–∏: gpt-oss:20b, deepseek-v3.1:671b, gpt-oss:120b",
        "info": "## –ù–∞—Å—Ç—Ä–æ–π–∫–∞:\n\n**Redis (Docker):**\n```bash\ndocker ps | grep redis\n# –ü–æ—Ä—Ç 6379 –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–æ–±—Ä–æ—à–µ–Ω\n```\n\n**Ollama –º–æ–¥–µ–ª–∏:**\n```bash\nollama list\n# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å:\n# - gpt-oss:20b-cloud\n# - deepseek-v3.1:671b-cloud  \n# - gpt-oss:120b-cloud\n```\n\n**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**\n```bash\ncurl -X POST http://localhost:1880/brainstorm \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"problem\": \"–ö–∞–∫ —É–ª—É—á—à–∏—Ç—å –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å?\"}'\n```",
        "x": 440,
        "y": 400,
        "wires": []
    },
    {
        "id": "flow_note",
        "type": "comment",
        "z": "flow1",
        "name": "üìä TEST MODE: –ü–æ—Ç–æ–∫ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç 6 —Å–ª–æ–≤ –≤–º–µ—Å—Ç–æ 36 –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–±—ã–ª–æ 72-180 —Å–µ–∫ ‚Üí —Å—Ç–∞–ª–æ 12-30 —Å–µ–∫)",
        "info": "",
        "x": 520,
        "y": 100,
        "wires": []
    },
    {
        "id": "9d5feb2ce34d68cb",
        "type": "debug",
        "z": "flow1",
        "name": "debug 1",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 5060,
        "y": 140,
        "wires": []
    },
    {
        "id": "e92dde3a0c5a0351",
        "type": "ui_template",
        "z": "flow1",
        "group": "f45ec5623cea7e52",
        "name": "",
        "order": 0,
        "width": 0,
        "height": 0,
        "format": "<h1>Hello</h1>\n<div ng-bind-html=\"msg.payload\"></div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 5060,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "5a4554ea23bf2cd1",
        "type": "markdown",
        "z": "flow1",
        "name": "",
        "property": "payload",
        "x": 5050,
        "y": 200,
        "wires": [
            [
                "debug_final",
                "e92dde3a0c5a0351"
            ]
        ]
    }
]